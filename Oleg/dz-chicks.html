<html>
<head>
  <meta name="http-equiv" content="Content-type: text/html;charset=utf-8">
    <title>dz chicks</title>
<body>
  
<script>
  
var testUrl = 'http://www.mocky.io/v2/5bc8b48732000082005a00b5';



 function load(x, func) {
      fetch(x)
        .then(function(response) {
          return response.json();
         })
        .then(function(data) {
          func(data);
        });
    };


  function afterAjax(data) {
    console.log('количество вариантов', data.length);
    var chicksRating = [];
    var counter = 0;
    k = 10;

    function takeChick(chick){
      console.log('берем: ', chick.name);
      // убираем ее из даты
      data.splice(chickCounter, 1);
      // убираем ее из рейтинга
      chicksRating.shift();
    }

    var counter = 0;
    while(counter < data.length){  
      chicksRating.push(data[counter].beauty / data[counter].admissibility);
      chicksRating.sort().reverse();
      counter++;
    };
    console.log('рейтинг телочек (список): ', chicksRating);


    var chickCounter = 0;
    var meetingCounter = 0;
    x = 0;
    while(meetingCounter < 10){

      var chick = data[chickCounter];
      var admis = Number.parseInt(chick.admissibility);

      // если кошелек позволяет пригласить эту чику
      if(k >= admis){
        // если это она
        if(chicksRating[x] == chick.beauty / admis) {
          takeChick(chick);
          chickCounter = 0;
          meetingCounter = meetingCounter + admis;
          k = k - admis;
        } else {
          chickCounter++;
        };

      } else {
        meetingCounter++;
        x++;
      };

    };

  };



load(testUrl, afterAjax);

            
</script>


</body>

</html>